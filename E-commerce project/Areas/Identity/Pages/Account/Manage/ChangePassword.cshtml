@page
@model ChangePasswordModel
@{
    ViewData["Title"] = "Change Password";
    ViewData["ActivePage"] = ManageNavPages.ChangePassword;
    bool hasExternalLogins = false;
    @using E_commerce.Model.Models
    @inject UserManager<ApplicationUser> _userManager
    var user = await _userManager.GetUserAsync(User);
    if (user != null)
    {
        var logins = await _userManager.GetLoginsAsync(user);

        hasExternalLogins = logins.Any();
    }
}

<div class="container-fluid p-0">
    <div class="row g-0 min-vh-100">
      
        <div class="col-lg-4 bg-dark text-white d-flex flex-column align-items-center justify-content-start p-4">
             <div class="text-center mb-4">
                <img src="@(!string.IsNullOrEmpty(Model.Input?.imageProfile)
                             ? Url.Content(Model.Input.imageProfile)
                             : Url.Content("~/images/default-user.png"))"
                     alt="Profile Picture"
                     class="rounded-circle border border-3 border-primary shadow mb-3"
                     style="width:130px; height:130px; object-fit:cover;" />

                <h4 class="fw-bold text-white">@Model.Input?.Name</h4>
                <p class="text-light small mb-1">@User.Identity?.Name</p>
                <span class="badge bg-primary px-3 py-2">@Model.Input?.Role</span>
            </div>

          
            <ul class="nav flex-column nav-pills w-100">
                <li class="nav-item mb-2">
                    <a class="nav-link text-white @ManageNavPages.IndexNavClass(ViewContext)" asp-page="./Index">
                        <i class="bi bi-person"></i> Profile
                    </a>
                </li>
                <li class="nav-item mb-2">
                    <a class="nav-link text-white @ManageNavPages.EmailNavClass(ViewContext)" asp-page="./Email">
                        <i class="bi bi-envelope"></i> Email
                    </a>
                </li>
                @if (!hasExternalLogins)
                {

                    <li class="nav-item mb-2">
                        <a class="nav-link text-white @ManageNavPages.ChangePasswordNavClass(ViewContext)" asp-page="./ChangePassword">
                            <i class="bi bi-lock"></i> Password
                        </a>
                    </li>
                }
            </ul>
        </div>

 
        <div class="col-lg-8 bg-secondary text-white p-5">
            <h3 class="mb-4 text-primary"><i class="bi bi-key"></i> Change Password</h3>

            <partial name="_StatusMessage" for="StatusMessage" />

            <form id="change-password-form" method="post">
                <div asp-validation-summary="ModelOnly" class="text-danger mb-3" role="alert"></div>

                <div class="form-floating mb-3">
                    <input asp-for="Input.OldPassword" class="form-control bg-dark text-white border-0" autocomplete="current-password" aria-required="true" placeholder="Please enter your old password." />
                    <label asp-for="Input.OldPassword" class="text-light"></label>
                    <span asp-validation-for="Input.OldPassword" class="text-danger"></span>
                </div>

                <div class="form-floating mb-3">
                    <input asp-for="Input.NewPassword" class="form-control bg-dark text-white border-0" autocomplete="new-password" aria-required="true" placeholder="Please enter your new password." />
                    <label asp-for="Input.NewPassword" class="text-light"></label>
                    <span asp-validation-for="Input.NewPassword" class="text-danger"></span>
                </div>

                <div class="form-floating mb-3">
                    <input asp-for="Input.ConfirmPassword" class="form-control bg-dark text-white border-0" autocomplete="new-password" aria-required="true" placeholder="Please confirm your new password." />
                    <label asp-for="Input.ConfirmPassword" class="text-light"></label>
                    <span asp-validation-for="Input.ConfirmPassword" class="text-danger"></span>
                </div>

                <button type="submit" class="btn btn-primary w-100 rounded-pill shadow mt-3 py-2">
                    <i class="bi bi-save"></i> Update Password
                </button>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
